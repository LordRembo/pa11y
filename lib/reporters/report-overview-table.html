<!DOCTYPE html>
<html lang="en">
<head>

	<meta charset="utf-8"/>
	<title>Accessibility Report For "{{& project}}" ({{date}})</title>

	<style>
		:root {
			--color-body: #333;
			--color-border: #efefef;
		}
		html {
			font-size: 10px;
		}
		body {
			margin: 0;
			padding: 0;
			background-color: #fff;
			font-family: Arial, Helvetica, sans-serif;
			font-size: 1.6rem;
			line-height: 22px;
			color: #333;
		}
		li {
			margin-bottom: 15px;
		}
		h2, h3, h4, p, pre, ul {
			margin-top: 0;
			margin-bottom: 20px;
		}
		p:last-child, pre:last-child, ul:last-child {
			margin-bottom: 0;
		}
		h1 {
			line-height: 1.1;
		}
		h2 {
			margin-bottom: 10px;
			font-size: 2.4rem;
			line-height: 1.1;
		}
		h3 {
			font-size: 2.1rem;
		}
		h4 {
			font-size: 1.6rem;
		}
		.table {
			width: 100%;
			margin-bottom: 20px;
			border-spacing: 0;
			border-collapse: collapse;
			box-shadow: 0 0px 3px 2px rgba(0,0,0,.2);
		}
		.table-heading,
		.table-cell {
			vertical-align: top;
			text-align: left;
			padding: 20px;
		}
		.table-heading {
			white-space: nowrap;
		}
		.table-cell {
			border-top: 1px solid var(--color-border);
		}
		.table-cell--techniques,
		.table-cell--pages,
		.table-cell--results,
		.table-cell--expand {
			text-align: right;
		}
		.table-cell--criterion {
			white-space: nowrap;
		}
		.criterion-page,
		.criterion-page-content {
			display: block;
			list-style: none;
			margin: 0;
			padding: 0;
		}
		.criterion-page li,
		.criterion-page-content li {
			display: block;
			list-style-type: none;
			margin: 0 0 20px 0;
			padding: 0;
		}
		button {
			cursor: pointer;
		}
		
		details {
			background: #efefef;
			border: 1px solid #ccc;
			border-radius: 5px;
			margin-bottom: 20px;
		}
		summary {
			padding: 5px 10px;
		}
		summary h2,
		summary h3 {
			display: inline-block;
		}
		.content {
			padding: 20px;
		}
		pre {
			font-family: monospace;
			white-space: pre-wrap;
			overflow: auto;
			padding: 10px;
			color: #efefef;
			background: #2f2f2f;
			border-radius: 5px;
			border: 1px solid #000;
			word-break: break-all;
		}
		.page {
			position: relative;
			max-width: 1200px;
			margin: 0 auto;
			padding: 25px;
		}
		.counts {
			list-style: none;
			display: flex;
			flex-wrap: wrap;
			padding: 0;
			margin: 30px -10px;
			font-size: 2.1rem;
			font-weight: bold;
		}
		.count {
			list-style: none;
			display: inline-block;
			margin: 0 10px;
		}
		.count-link {
			display: inline-block;
			padding: 5px;
			border-radius: 5px;
			border: 1px solid #eee;
		}

		.count-link,
		.count-link:visited {
			color: var(--color-body);
			text-decoration: none;
		}

		.clean-list {
			margin-left: 0;
			padding-left: 0;
			list-style: none;
		}
		.result,
		li.result {
			padding: 10px;
			border-radius: 5px;
			border: 1px solid #eee;
		}
		li.result:first-child {
			margin-top: 20px;
		}
		.table-row--error th,
		.error,
		li.error {
			background-color: #fdd;
			border-color: #ff9696;
		}
		.table-row--warning th,
		.warning,
		li.warning {
			background-color: #ffd;
			border-color: #e7c12b;
		}
		.table-row--notice th,
		.notice,
		li.notice {
			background-color: #eef4ff;
			border-color: #b6d0ff;
		}
		.accordion-content.is-closed {
			display: none;
		}
		.accordion-content td {
			background: var(--color-border);
		}
		.back-to-top {
			display: inline-block;
			padding: 10px;
			margin-top: 10px;
			white-space: nowrap;
			background: white;
		}
		
		@media print {
			* {
				-webkit-print-color-adjust: exact !important;
				color-adjust: exact !important;
				print-color-adjust: exact !important;
			}
			html,
			body {
				margin: 0;
			}
			body {
				font-size: 10pt;
				margin: 1pt;
			}
			.page {
				max-width: none;
			}
			.table {
				box-shadow: none;
				border: 1pt solid #ccc;
			}
			.table-cell {
				border-top: 1pt solid #ccc;
			}
			.back-to-top,
			.btn-expand {
				display: none;
			}
			.table-row--criterion .table-cell {
				padding-bottom: 10px;
			}
			.criterion-page-header a,
			.criterion-page-header a:link,
			.criterion-page-header a:visited {
				color: var(--color-body);
				text-decoration: none;
			}
			.accordion-content.is-closed {
				display: block;
			}
			tr.accordion-content.is-closed {
				display: table-row;
			}
			.table-cell--expand {
				width: 0;
				display: none;
			}
			.accordion-content td {
				width: 100%;
				padding-top: 0;
				border-top: 0 none;
				background-color: transparent;
			}
			.result {
    		break-inside: avoid;
			}
			.table {
				page-break-after: always;
			}
			.criterion-page-header,
			.table-row--criterion {
				page-break-after: avoid;
			}
			.criterion-page-content {
				page-break-before: avoid;
			}

		}
	</style>

	<script>
		class Accordion {
			constructor(domNode) {
				this.rootEl = domNode;
				this.buttonEl = this.rootEl.querySelector('.btn-expand');

				const controlsId = this.buttonEl.getAttribute('aria-controls');
				this.contentEl = document.getElementById(controlsId);

				this.open = this.buttonEl.getAttribute('aria-expanded') === 'true';

				// add event listeners
				this.buttonEl.addEventListener('click', this.onButtonClick.bind(this));
			}

			onButtonClick() {
				this.toggle(!this.open);
			}

			toggle(open) {
				// don't do anything if the open state doesn't change
				if (open === this.open) {
					return;
				}

				// update the internal state
				this.open = open;

				// handle DOM updates
				this.buttonEl.setAttribute('aria-expanded', `${open}`);
				if (open) {
					this.contentEl.classList.remove('is-closed');
					// this.contentEl.removeAttribute('hidden');

					// make toggles for the pages
					const accordions02 = this.contentEl.querySelectorAll('.criterion-page-header');
					accordions02.forEach((accordionEl) => {
						new Accordion(accordionEl);
					});
				} else {
					this.contentEl.classList.add('is-closed');
					// this.contentEl.setAttribute('hidden', '');
				}

			}

			// Add public open and close methods for convenience
			open() {
				this.toggle(true);
			}

			close() {
				this.toggle(false);
			}
		}

		document.addEventListener("DOMContentLoaded", (event) => {
			// init accordions
			const accordions01 = document.querySelectorAll('td.table-cell--expand');
			accordions01.forEach((accordionEl) => {
				new Accordion(accordionEl);
			});
		});
	</script>

</head>
<body>

	<div class="page">

		<h1 id="top">Accessibility Report For "{{& name}}"</h1>
		{{^singlePage}}<p><strong>Generated at:</strong> {{date}}</p>{{/singlePage}}
		{{#singlePage}}
		<ul>
			<li><strong>Generated at:</strong> {{date}}</li>
			<li><strong>Page:</strong> {{pageUrl}}"</li>
		</ul>
		{{/singlePage}}

		<ul class="counts">
			{{#issues}}
			<li class="count"><a class="count-link {{type}}" href="#{{type}}">{{issueCount}} {{label}}</a></li>
			{{/issues}}
		</ul>

		{{#issues}}
		<table class="table table--{{type}}">
			<tr class="table-row table-row--{{type}}">
				<th class="table-heading table-cell--criterion">
					Success criterion
				</th>

				<th class="table-heading table-cell--techniques">
					Suggested techniques
				</th>

				<th class="table-heading table-cell--pages">
					Pages
				</th>

				<th class="table-heading table-cell--results">
					Results
				</th>

				<th class="table-heading table-cell--expand">
					Expand
				</th>
			</tr>
			{{#criteria}}
			<tr class="table-row table-row--criterion">
				<td class="table-cell table-cell--criterion">
					{{label}}
				</td>
				<td class="table-cell table-cell--techniques">
					{{#techniques}}{{.}}{{/techniques}}
				</td>
				<td class="table-cell table-cell--pages">
					{{pageCount}}
				</td>
				<td class="table-cell table-cell--results">
					{{issueCount}}
				</td>
				<td class="table-cell table-cell--expand">
					<button class="btn-expand" aria-expanded="false" aria-controls="{{idx}}-content" id="{{idx}}-title" title="toggle issues" aria-label="toggle issues">+</button>
				</td>
			</tr>
			<tr id="{{idx}}-content" class="accordion-content is-closed">
				<td class="table-cell" colspan="5">
					{{#pages}}
					<ul class="criterion-page">
						<li>
							<div class="criterion-page-header">
								<strong><a href="{{pageUrl}}" target="_blank" title="visit page {{documentTitle}}">{{pageUrl}}</a></strong> ({{pageIssueCount}} errors)
								<button class="btn-expand" aria-expanded="false" aria-controls="{{idx}}-page-{{pageNumber}}-errors" id="{{idx}}-title" title="toggle page issues" aria-label="toggle page issues">+</button>
							</div>
							<ul class="criterion-page-content accordion-content is-closed" id="{{idx}}-page-{{pageNumber}}-errors" class="clean-list results-list">
								{{#issues}}
								<li class="result {{type}}">
									<h4>{{typeLabel}}: {{message}}</h4>
									<pre>{{context}} (select with "{{selector}}")</pre>
								</li>
								{{/issues}}
							</ul>
						</li>
					</ul>
					{{/pages}}
				</td>

			</tr>
			{{/criteria}}

		</table>
		{{/issues}}

		<a class="back-to-top" href="#top">back to top</a>

	</div>

</body>
</html>
